# 功能测试快速指南

## 🚀 快速开始

### 1️⃣ 启动服务

```bash
# 使用启动脚本（推荐）
./start.sh        # Mac/Linux
# 或
start.bat         # Windows
```

### 2️⃣ 运行测试

```bash
cd frontend

# 运行所有E2E测试
npm run test:e2e

# UI模式运行（推荐，可视化调试）
npm run test:e2e:ui
```

## 📋 测试覆盖内容

### ✅ 页面加载与跳转
- 路由重定向
- 导航菜单跳转
- 页面间切换
- 无效路径处理

### ✅ 表单输入与提交
- **客户管理**：创建、编辑、删除客户
- **产品管理**：基础产品、组合产品、库存调整
- **订单管理**：创建订单、选择客户和产品
- 必填字段验证
- 错误提示显示
- 成功消息确认

### ✅ 交互逻辑
- 按钮点击响应
- Modal弹窗打开/关闭
- 下拉菜单选择
- Tab切换
- Popconfirm确认对话框
- 分页功能
- 筛选和搜索

### ✅ 业务流程
- 订单创建完整流程
- 订单出货流程
- 库存调整流程
- 订单状态更新

## 🎯 常用测试命令

```bash
# 在 frontend 目录下执行

# 运行所有测试
npm run test:e2e

# UI模式（可视化，推荐）
npm run test:e2e:ui

# 调试模式
npm run test:e2e:debug

# 查看测试报告
npm run test:e2e:report

# 运行特定测试
npm run test:navigation    # 页面导航测试
npm run test:customer       # 客户CRUD测试
npm run test:product        # 产品和库存测试
npm run test:order          # 订单创建测试
npm run test:shipment       # 订单出货测试
npm run test:filter         # 筛选功能测试

# 显示浏览器窗口运行
npm run test:e2e:headed
```

## 📁 测试文件位置

```
frontend/tests/e2e/
├── navigation.spec.ts        - 页面跳转和路由
├── customer-crud.spec.ts     - 客户管理
├── product-crud.spec.ts      - 产品和库存
├── order-workflow.spec.ts    - 订单创建
├── order-shipment.spec.ts    - 订单出货
└── filters-search.spec.ts    - 筛选搜索
```

## 🔧 首次运行准备

如果是第一次运行测试，需要安装Playwright浏览器：

```bash
cd frontend
npx playwright install
```

## 📊 测试结果

测试运行后会显示：
- ✅ 通过的测试数量
- ❌ 失败的测试详情
- ⏱️ 执行时间
- 📸 失败时的截图（保存在 tests/.playwright-output）

查看详细报告：
```bash
npm run test:e2e:report
```

## 🐛 调试技巧

### 1. 使用UI模式（最简单）
```bash
npm run test:e2e:ui
```
- 可以看到浏览器操作过程
- 逐步执行测试
- 查看每个步骤的截图

### 2. 使用调试模式
```bash
npm run test:e2e:debug
```
- 自动打开DevTools
- 可以设置断点
- 单步执行

### 3. 只运行单个测试
```bash
npx playwright test navigation.spec.ts --debug
```

## ⚠️ 注意事项

1. **确保服务运行**：测试前必须启动前端和后端服务
2. **测试数据**：测试会创建带"测试_"前缀的数据，可以定期清理
3. **数据库状态**：测试使用真实数据库，确保有初始数据（客户、产品）
4. **端口占用**：确保3000（前端）和5001（后端）端口未被占用

## 📖 详细文档

完整的测试文档请查看：
- `frontend/tests/TEST_GUIDE.md` - 详细测试指南
- `playwright.config.js` - Playwright配置

## 💡 快速问题解决

### Q: 测试超时失败
```bash
# 增加超时时间
npx playwright test --timeout=60000
```

### Q: 找不到元素
- 检查页面是否加载完成
- 使用UI模式查看实际页面状态
- 确认选择器是否正确

### Q: 测试数据冲突
- 清理数据库中带"测试_"前缀的数据
- 或使用独立的测试数据库

## ✨ 测试特色

- 🎨 **完整覆盖**：涵盖所有核心功能
- 🔍 **细致验证**：表单验证、错误提示、成功消息
- 🔄 **流程测试**：完整业务流程端到端测试
- 📱 **交互测试**：键盘、鼠标、下拉等各种交互
- 🚦 **状态检查**：页面状态、数据更新、UI反馈

---

**开始测试，确保系统稳定可靠！** 🎉


