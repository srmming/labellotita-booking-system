# 🎯 新功能使用指南

## 📋 快速导航

- [库存调整功能](#库存调整功能)
- [产品分类管理](#产品分类管理)
- [订单创建限制](#订单创建限制)
- [常见操作示例](#常见操作示例)

---

## 🔧 库存调整功能

### 功能位置
**产品管理** → **基础产品** Tab → **库存调整** 按钮

### 使用场景

#### 场景1：采购入库
```
操作：增加库存
数量：100
原因：2024年10月采购入库
```

#### 场景2：库存盘点
```
操作：增加/减少（根据实际）
数量：58
原因：月度盘点调整 - 实际多出58个
```

#### 场景3：损耗处理
```
操作：减少库存
数量：10
原因：产品过期报废
```

#### 场景4：退货处理
```
操作：减少库存
数量：20
原因：客户退货，产品已损坏无法再售
```

### 操作步骤

1. **打开调整弹窗**
   - 在基础产品列表找到目标产品
   - 点击"库存调整"按钮

2. **填写调整信息**
   - 选择调整类型：增加/减少
   - 输入调整数量（如：100, 58）
   - **必填**：填写调整原因

3. **提交确认**
   - 检查当前库存显示
   - 点击确定提交

4. **验证结果**
   - 库存数字已更新
   - 可点击"调整历史"查看记录

### 查看调整历史

点击任意基础产品的 **"调整历史"** 按钮，可以看到：

| 时间 | 类型 | 数量 | 调整前 | 调整后 | 原因 |
|------|------|------|--------|--------|------|
| 2025-10-10 14:30 | 增加 | 100 | 50 | 150 | 采购入库 |
| 2025-10-10 10:20 | 减少 | 10 | 60 | 50 | 产品损耗 |

---

## 📂 产品分类管理

### Tab切换

产品管理页面现在分为两个Tab：

#### 1. 组合产品 Tab
- 显示所有组合产品
- 查看组件配置
- 编辑/删除操作

#### 2. 基础产品 Tab
- 显示所有基础产品
- 显示当前库存
- **库存调整**功能
- **调整历史**查询
- 编辑/删除操作

### 分页功能

- 每页显示 **10 条** 数据
- 页面底部显示分页器
- 显示总数：如"共 15 条"
- 组合产品和基础产品独立分页

---

## 🛒 订单创建限制

### 重要变更

**订单只能销售组合产品！**

#### 为什么？
- 基础产品是原材料/组件
- 组合产品是完整的销售商品
- 清晰的业务边界

### 创建订单时

1. **产品选择器只显示组合产品**
   - 下拉框只列出组合产品
   - 标注"选择组合产品"

2. **后端自动验证**
   - 如果尝试添加基础产品
   - 系统会拒绝并提示错误

3. **错误提示示例**
   ```
   订单只能销售组合产品。
   产品 "香薰蜡烛" 是基础产品，不能直接销售。
   ```

---

## 💡 常见操作示例

### 示例1：新采购100个蜡烛

**步骤**：
1. 进入 **产品管理** → **基础产品** Tab
2. 找到"香薰蜡烛"
3. 点击 **库存调整**
4. 选择：增加库存
5. 数量：100
6. 原因："2024年10月采购入库"
7. 确认

**结果**：
- 蜡烛库存增加 100
- 调整历史中新增一条记录

---

### 示例2：盘点发现少了58个精油

**步骤**：
1. 进入 **产品管理** → **基础产品** Tab
2. 找到"精油"
3. 点击 **库存调整**
4. 选择：减少库存
5. 数量：58
6. 原因："月度盘点 - 实际少58个，原因待查"
7. 确认

**结果**：
- 精油库存减少 58
- 系统记录此次调整

---

### 示例3：创建组合产品订单

**步骤**：
1. 进入 **订单管理** → **新建订单**
2. 选择客户：张三
3. 添加产品：
   - 产品：节日礼品套装（✅ 组合产品）
   - 数量：10
4. 付款状态：已付款
5. 订单金额：1500
6. 提交

**结果**：
- 订单创建成功
- 订单号自动生成（如：ORD-20251010-0001）

---

### 示例4：出货并自动扣减库存

**步骤**：
1. 进入订单详情页
2. 点击 **新增出货**
3. 选择产品：节日礼品套装
4. 出货数量：5（部分出货）
5. 确认出货

**系统自动处理**：
1. ✅ 创建出货记录
2. ✅ 展开组合产品：
   - 节日礼品套装 = 蜡烛×2 + 精油×1 + 礼品盒×1
3. ✅ 自动扣减基础产品库存：
   - 蜡烛：-10（5个套装 × 2）
   - 精油：-5（5个套装 × 1）
   - 礼品盒：-5（5个套装 × 1）
4. ✅ 更新订单状态为"出货中"

**注意**：出货扣减的库存**不会**出现在"调整历史"中，这是正常的设计。

---

## ❓ 常见问题

### Q1: 为什么基础产品不能直接销售？
**A:** 基础产品是原材料/组件，只作为组合产品的一部分对外销售。这是业务规则设计。

### Q2: 库存调整和出货扣减有什么区别？
**A:** 
- **库存调整**：人工操作（采购、盘点、损耗等），有调整历史
- **出货扣减**：系统自动（出货时自动扣减），不在调整历史中

### Q3: 调整原因可以随便写吗？
**A:** 不建议。原因是为了审计和追溯，应该写清楚：
- ✅ 好的原因："2024年10月采购入库"
- ✅ 好的原因："月度盘点 - 实际少10个"
- ❌ 不好："调整"、"随便"

### Q4: 库存调整能调整组合产品吗？
**A:** 不能。只能调整基础产品库存。组合产品没有实体库存。

### Q5: 如果库存不足，能减少吗？
**A:** 系统会阻止。例如当前库存50，不能减少100。会提示错误。

---

## 🎯 最佳实践

### 1. 库存调整原因规范

**推荐格式**：
```
[日期] [操作] - [详细说明]

例如：
- 2024-10-10 采购入库 - 供应商A交货
- 2024-10-10 盘点调整 - 实际多出20个
- 2024-10-10 损耗处理 - 产品过期报废
- 2024-10-10 退货入库 - 客户订单取消
```

### 2. 定期盘点

**建议流程**：
1. 每月末进行实物盘点
2. 对比系统库存和实际库存
3. 发现差异立即调整
4. 原因中注明"X月盘点调整"

### 3. 查看历史追溯

当发现库存异常时：
1. 点击"调整历史"
2. 查看最近的调整记录
3. 分析原因
4. 必要时联系相关人员

---

## 🚀 快速测试

### 测试清单

- [ ] 增加库存100（采购入库）
- [ ] 减少库存50（盘点调整）
- [ ] 查看调整历史
- [ ] 尝试创建组合产品订单
- [ ] 尝试创建基础产品订单（应该失败）
- [ ] Tab切换（组合/基础）
- [ ] 分页功能测试

---

## 📞 获取帮助

如有问题，请查看：
- [完整文档](./README.md)
- [更新说明](./更新说明.md)
- [架构文档](./ARCHITECTURE.md)

---

**祝使用愉快！** 🎉












